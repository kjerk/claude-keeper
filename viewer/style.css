/* ── Structural (theme-independent) ────── */
:root {
	--radius: 8px;
	--shadow-medium: 0 4px 16px rgba(0,0,0,0.4);
	--transition: 180ms ease;
	--max-content: 780px;
	--panel-width: 520px;
}

/* ── Dark Theme ───────────────────────── */
[data-theme="dark"] {
	--theme-label: "Dark";
	--theme-type: "dark";

	--bg-primary: #0f0f0f;
	--bg-secondary: #1a1a1a;
	--bg-tertiary: #242424;
	--bg-hover: #2a2a2a;
	--header-bg: rgba(15, 15, 15, 0.85);

	--text-primary: #e8e4df;
	--text-secondary: #a39e96;
	--text-muted: #6b6560;
	--text-strong: #f0ece7;

	--accent: #d4956a;
	--accent-dim: #9e6f4e;
	--accent-glow: rgba(212, 149, 106, 0.08);

	--border: #2a2826;
	--border-light: #3a3835;

	--human-indicator: #7a9bb5;
	--assistant-indicator: #d4956a;
	--thinking-indicator: #8b7ec8;
	--tool-indicator: #6ab587;

	--surface-thinking: #1a1a2e;
	--surface-thinking-border: #2a2a44;
	--surface-thinking-hover: rgba(139, 126, 200, 0.06);

	--surface-tool: #1a2418;
	--surface-tool-border: #2a3a28;
	--surface-tool-hover: rgba(106, 181, 135, 0.06);

	--surface-attachment: #261a17;
	--surface-attachment-border: #3a2a22;
	--surface-attachment-hover: #2d1f18;

	--code-bg: #1e1e1e;
	--code-header-bg: #252525;

	--drag-overlay-bg: rgba(15, 15, 15, 0.92);
}

/* ── Light Theme ──────────────────────── */
[data-theme="light"] {
	--theme-label: "Light";
	--theme-type: "light";

	--bg-primary: #f8f7f5;
	--bg-secondary: #efeeec;
	--bg-tertiary: #e5e3e0;
	--bg-hover: #dbd9d5;
	--header-bg: rgba(248, 247, 245, 0.88);

	--text-primary: #1c1b1a;
	--text-secondary: #5c5850;
	--text-muted: #9a958e;
	--text-strong: #1c1b1a;

	--accent: #b5713f;
	--accent-dim: #c49060;
	--accent-glow: rgba(181, 113, 63, 0.08);

	--border: #d8d5d0;
	--border-light: #c8c5c0;

	--human-indicator: #5a849e;
	--assistant-indicator: #b5713f;
	--thinking-indicator: #6b5ea8;
	--tool-indicator: #4a9567;

	--surface-thinking: #ededf5;
	--surface-thinking-border: #d0d0e0;
	--surface-thinking-hover: rgba(107, 94, 168, 0.06);

	--surface-tool: #edf5ed;
	--surface-tool-border: #c0d8c0;
	--surface-tool-hover: rgba(74, 149, 103, 0.06);

	--surface-attachment: #f5efed;
	--surface-attachment-border: #d8c8c0;
	--surface-attachment-hover: #f0e8e5;

	--code-bg: #f0eeeb;
	--code-header-bg: #e8e6e3;

	--drag-overlay-bg: rgba(248, 247, 245, 0.92);
}

/* ── Zenburn ──────────────────────────── */
[data-theme="zenburn"] {
	--theme-label: "Zenburn";
	--theme-type: "dark";

	--bg-primary: #3f3f3f;
	--bg-secondary: #4f4f4f;
	--bg-tertiary: #525252;
	--bg-hover: #5a5a5a;
	--header-bg: rgba(63, 63, 63, 0.85);

	--text-primary: #dcdccc;
	--text-secondary: #c0c0a0;
	--text-muted: #7f9f7f;
	--text-strong: #ffffef;

	--accent: #f0dfaf;
	--accent-dim: #d0bf8f;
	--accent-glow: rgba(240, 223, 175, 0.08);

	--border: #4f4f4f;
	--border-light: #5f5f5f;

	--human-indicator: #8cd0d3;
	--assistant-indicator: #f0dfaf;
	--thinking-indicator: #dc8cc3;
	--tool-indicator: #7f9f7f;

	--surface-thinking: #3f3f4f;
	--surface-thinking-border: #4f4f5f;
	--surface-thinking-hover: rgba(220, 140, 195, 0.06);

	--surface-tool: #3a4a3a;
	--surface-tool-border: #4a5a4a;
	--surface-tool-hover: rgba(127, 159, 127, 0.06);

	--surface-attachment: #4a4038;
	--surface-attachment-border: #5a5048;
	--surface-attachment-hover: #504538;

	--code-bg: #383838;
	--code-header-bg: #434343;

	--drag-overlay-bg: rgba(63, 63, 63, 0.92);
}

/* ── Monokai ─────────────────────────── */
[data-theme="monokai"] {
	--theme-label: "Monokai";
	--theme-type: "dark";

	--bg-primary: #272822;
	--bg-secondary: #3e3d32;
	--bg-tertiary: #49483e;
	--bg-hover: #555446;
	--header-bg: rgba(39, 40, 34, 0.85);

	--text-primary: #f8f8f2;
	--text-secondary: #cfcfc2;
	--text-muted: #75715e;
	--text-strong: #ffffff;

	--accent: #a6e22e;
	--accent-dim: #8ab21e;
	--accent-glow: rgba(166, 226, 46, 0.08);

	--border: #49483e;
	--border-light: #555446;

	--human-indicator: #66d9ef;
	--assistant-indicator: #e6db74;
	--thinking-indicator: #ae81ff;
	--tool-indicator: #a6e22e;

	--surface-thinking: #2d2842;
	--surface-thinking-border: #3d384f;
	--surface-thinking-hover: rgba(174, 129, 255, 0.06);

	--surface-tool: #2a3022;
	--surface-tool-border: #3a4032;
	--surface-tool-hover: rgba(166, 226, 46, 0.06);

	--surface-attachment: #302822;
	--surface-attachment-border: #403832;
	--surface-attachment-hover: #352d25;

	--code-bg: #1e1f1a;
	--code-header-bg: #2d2e28;

	--drag-overlay-bg: rgba(39, 40, 34, 0.92);
}

/* ── Solarized Dark ──────────────────── */
[data-theme="solarized-dark"] {
	--theme-label: "Solarized Dark";
	--theme-type: "dark";

	--bg-primary: #002b36;
	--bg-secondary: #073642;
	--bg-tertiary: #094050;
	--bg-hover: #0a4a5a;
	--header-bg: rgba(0, 43, 54, 0.85);

	--text-primary: #839496;
	--text-secondary: #657b83;
	--text-muted: #586e75;
	--text-strong: #93a1a1;

	--accent: #268bd2;
	--accent-dim: #2176b8;
	--accent-glow: rgba(38, 139, 210, 0.08);

	--border: #073642;
	--border-light: #094050;

	--human-indicator: #268bd2;
	--assistant-indicator: #b58900;
	--thinking-indicator: #6c71c4;
	--tool-indicator: #859900;

	--surface-thinking: #0a2040;
	--surface-thinking-border: #1a3050;
	--surface-thinking-hover: rgba(108, 113, 196, 0.06);

	--surface-tool: #002a20;
	--surface-tool-border: #003a30;
	--surface-tool-hover: rgba(133, 153, 0, 0.06);

	--surface-attachment: #1a2016;
	--surface-attachment-border: #2a3026;
	--surface-attachment-hover: #1f2518;

	--code-bg: #00212b;
	--code-header-bg: #073642;

	--drag-overlay-bg: rgba(0, 43, 54, 0.92);
}

/* ── Solarized Light ─────────────────── */
[data-theme="solarized-light"] {
	--theme-label: "Solarized Light";
	--theme-type: "light";

	--bg-primary: #fdf6e3;
	--bg-secondary: #eee8d5;
	--bg-tertiary: #e5dfcc;
	--bg-hover: #dcd6c3;
	--header-bg: rgba(253, 246, 227, 0.88);

	--text-primary: #586e75;
	--text-secondary: #657b83;
	--text-muted: #93a1a1;
	--text-strong: #073642;

	--accent: #268bd2;
	--accent-dim: #2176b8;
	--accent-glow: rgba(38, 139, 210, 0.08);

	--border: #eee8d5;
	--border-light: #dcd6c3;

	--human-indicator: #268bd2;
	--assistant-indicator: #b58900;
	--thinking-indicator: #6c71c4;
	--tool-indicator: #859900;

	--surface-thinking: #ede8f0;
	--surface-thinking-border: #d0cce0;
	--surface-thinking-hover: rgba(108, 113, 196, 0.06);

	--surface-tool: #e8f0e0;
	--surface-tool-border: #c8d8b8;
	--surface-tool-hover: rgba(133, 153, 0, 0.06);

	--surface-attachment: #f5ede0;
	--surface-attachment-border: #e0d0c0;
	--surface-attachment-hover: #f0e8d8;

	--code-bg: #eee8d5;
	--code-header-bg: #e5dfcc;

	--drag-overlay-bg: rgba(253, 246, 227, 0.92);
}

/* ── Base Reset ───────────────────────── */
* { margin: 0; padding: 0; box-sizing: border-box; }

html {
	font-size: 16px;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
}

body {
	font-family: 'DM Sans', -apple-system, sans-serif;
	background: var(--bg-primary);
	color: var(--text-primary);
	line-height: 1.7;
	min-height: 100vh;
	overflow-x: hidden;
}

/* ── Drop Zone ─────────────────────────── */
#drop-zone {
	position: fixed; inset: 0;
	display: flex; flex-direction: column;
	align-items: center; justify-content: center;
	z-index: 100; background: var(--bg-primary);
	transition: opacity 0.4s ease;
}

#drop-zone.hidden { opacity: 0; pointer-events: none; }

.drop-area {
	width: 520px; max-width: 90vw;
	padding: 64px 48px;
	border: 2px dashed var(--border-light);
	border-radius: 16px; text-align: center;
	transition: all var(--transition); cursor: pointer;
}

.drop-area:hover, .drop-area.drag-over {
	border-color: var(--accent-dim); background: var(--accent-glow);
}

.drop-area.drag-over { transform: scale(1.01); }

.drop-icon {
	width: 56px; height: 56px; margin: 0 auto 24px;
	border-radius: 50%; background: var(--bg-tertiary);
	display: flex; align-items: center; justify-content: center;
	color: var(--accent); font-size: 24px;
}

.drop-title {
	font-family: 'Newsreader', Georgia, serif;
	font-size: 1.5rem; font-weight: 500;
	color: var(--text-primary); margin-bottom: 8px;
}

.drop-subtitle { color: var(--text-muted); font-size: 0.875rem; margin-bottom: 24px; }

.drop-browse {
	display: inline-block; padding: 10px 24px;
	background: var(--bg-tertiary); border: 1px solid var(--border-light);
	border-radius: 8px; color: var(--text-secondary);
	font-size: 0.875rem; font-family: inherit;
	cursor: pointer; transition: all var(--transition);
}

.drop-browse:hover {
	background: var(--bg-hover); color: var(--text-primary); border-color: var(--accent-dim);
}

#file-input { display: none; }

.drop-hint {
	margin-top: 32px; font-size: 0.75rem;
	color: var(--text-muted); opacity: 0.6;
}

/* ── Drag Overlay (drop-to-replace) ───── */
.drag-overlay {
	position: fixed; inset: 0; z-index: 200;
	display: flex; align-items: center; justify-content: center;
	background: var(--drag-overlay-bg);
	backdrop-filter: blur(8px); -webkit-backdrop-filter: blur(8px);
	opacity: 0; pointer-events: none;
	transition: opacity 0.25s ease;
}

.drag-overlay.visible {
	opacity: 1; pointer-events: all;
}

.drag-overlay-content {
	text-align: center;
	padding: 48px;
	border: 2px dashed var(--accent-dim);
	border-radius: 16px;
}

.drag-overlay-content .drop-icon {
	margin-bottom: 16px;
}

.drag-overlay-text {
	font-family: 'Newsreader', Georgia, serif;
	font-size: 1.25rem; font-weight: 500;
	color: var(--text-primary);
}

.drag-overlay-hint {
	font-size: 0.8rem; color: var(--text-muted); margin-top: 8px;
}

/* ── App ───────────────────────────────── */
#app { display: none; min-height: 100vh; }
#app.visible { display: flex; flex-direction: column; }

/* ── Header ────────────────────────────── */
.header {
	position: sticky; top: 0; z-index: 50;
	background: var(--header-bg);
	backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
	border-bottom: 1px solid var(--border); padding: 0 24px;
}

.header-inner {
	max-width: 1000px; margin: 0 auto;
	display: flex; align-items: center; justify-content: space-between;
	height: 56px;
}

.header-left { display: flex; align-items: center; gap: 12px; min-width: 0; }

.header-logo {
	width: 28px; height: 28px; border-radius: 6px;
	background: linear-gradient(135deg, var(--accent), var(--accent-dim));
	display: flex; align-items: center; justify-content: center;
	font-size: 14px; font-weight: 600; color: #0f0f0f; flex-shrink: 0;
}

.header-title {
	font-family: 'Newsreader', Georgia, serif;
	font-size: 1.05rem; font-weight: 500; color: var(--text-primary);
	white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.header-meta { display: flex; align-items: center; gap: 8px; flex-shrink: 0; }

.header-badge {
	font-size: 0.7rem; font-weight: 500;
	letter-spacing: 0.04em; text-transform: uppercase;
	padding: 3px 8px; border-radius: 4px;
	background: var(--bg-tertiary); color: var(--text-muted); border: 1px solid var(--border);
}

.header-btn {
	display: flex; align-items: center; gap: 6px;
	padding: 6px 12px; font-size: 0.8rem; font-family: inherit;
	color: var(--text-secondary); background: var(--bg-tertiary);
	border: 1px solid var(--border); border-radius: 6px;
	cursor: pointer; transition: all var(--transition);
}

.header-btn:hover {
	color: var(--text-primary); border-color: var(--border-light); background: var(--bg-hover);
}

/* ── Theme Picker ─────────────────────── */
.theme-picker {
	position: relative;
}

.theme-menu {
	display: none;
	position: absolute; top: 100%; right: 0;
	margin-top: 6px; padding: 4px;
	background: var(--bg-secondary);
	border: 1px solid var(--border-light);
	border-radius: 8px;
	box-shadow: var(--shadow-medium);
	min-width: 140px; z-index: 60;
}

.theme-menu.open { display: block; }

.theme-option {
	display: flex; align-items: center; gap: 8px;
	width: 100%; padding: 8px 12px;
	border: none; border-radius: 6px;
	background: transparent;
	color: var(--text-secondary);
	font-size: 0.8rem; font-family: inherit;
	cursor: pointer; transition: all var(--transition);
	text-align: left;
}

.theme-option:hover { background: var(--bg-hover); color: var(--text-primary); }
.theme-option.active { color: var(--accent); }

.theme-option-dot {
	width: 8px; height: 8px; border-radius: 50%;
	border: 1px solid var(--border-light);
	flex-shrink: 0;
}

/* ── Messages ──────────────────────────── */
.messages { flex: 1; padding: 24px 24px 80px; }
.messages-inner { max-width: var(--max-content); margin: 0 auto; }

.message {
	padding: 28px 0; border-bottom: 1px solid var(--border);
	animation: msgIn 0.3s ease both;
}

.message:last-child { border-bottom: none; }

@keyframes msgIn {
	from { opacity: 0; transform: translateY(6px); }
	to { opacity: 1; transform: translateY(0); }
}

.message-header { display: flex; align-items: center; margin-bottom: 14px; }
.message-sender { display: flex; align-items: center; gap: 10px; }

.sender-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.sender-dot.human { background: var(--human-indicator); }
.sender-dot.assistant { background: var(--assistant-indicator); }

.sender-label {
	font-size: 0.8rem; font-weight: 600;
	letter-spacing: 0.03em; text-transform: uppercase; color: var(--text-secondary);
}

/* ── Message Footer ────────────────────── */
.message-footer {
	display: flex; align-items: center; gap: 8px;
	margin-top: 14px; min-height: 32px;
}

.branch-nav {
	display: inline-flex; align-items: center; gap: 2px;
	background: var(--bg-tertiary); border: 1px solid var(--border);
	border-radius: 6px; padding: 2px;
}

.branch-btn {
	display: flex; align-items: center; justify-content: center;
	width: 26px; height: 26px; border: none; border-radius: 4px;
	background: transparent; color: var(--text-muted);
	cursor: pointer; transition: all var(--transition);
	font-size: 13px; font-family: inherit;
}

.branch-btn:hover:not(:disabled) { background: var(--bg-hover); color: var(--text-secondary); }
.branch-btn:disabled { opacity: 0.25; cursor: default; }

.branch-label {
	font-size: 0.7rem; font-weight: 500; color: var(--text-muted);
	padding: 0 6px; font-variant-numeric: tabular-nums;
	min-width: 36px; text-align: center;
}

.msg-actions {
	display: flex; align-items: center; gap: 2px;
	opacity: 0; transition: opacity var(--transition);
}

.message:hover .msg-actions { opacity: 1; }

.msg-action-btn {
	display: flex; align-items: center; justify-content: center;
	width: 32px; height: 32px; border: none; border-radius: 6px;
	background: transparent; color: var(--text-muted);
	cursor: pointer; transition: all var(--transition); position: relative;
}

.msg-action-btn:hover { background: var(--bg-tertiary); color: var(--text-secondary); }
.msg-action-btn svg { width: 18px; height: 18px; }

.msg-action-btn .icon-copy,
.msg-action-btn .icon-check {
	position: absolute; top: 50%; left: 50%;
	transform: translate(-50%, -50%); transition: all 0.2s ease;
}

.msg-action-btn .icon-check { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
.msg-action-btn.copied .icon-copy { opacity: 0; transform: translate(-50%, -50%) scale(0.5); }
.msg-action-btn.copied .icon-check {
	opacity: 1; transform: translate(-50%, -50%) scale(1); color: var(--tool-indicator);
}

.message-timestamp {
	font-size: 0.7rem; color: var(--text-muted);
	opacity: 0; transition: opacity var(--transition); margin-left: auto;
}

.message:hover .message-timestamp { opacity: 1; }

/* ── Content ───────────────────────────── */
.message-body { font-size: 0.95rem; line-height: 1.75; color: var(--text-primary); }
.message-body p { margin-bottom: 0.85em; }
.message-body p:last-child { margin-bottom: 0; }
.message-body ul, .message-body ol { margin: 0.5em 0 0.85em 1.5em; }
.message-body li { margin-bottom: 0.3em; }
.message-body strong { font-weight: 600; color: var(--text-strong); }
.message-body em { font-style: italic; }

.message-body a {
	color: var(--accent); text-decoration: none;
	border-bottom: 1px solid var(--accent-dim); transition: border-color var(--transition);
}

.message-body a:hover { border-color: var(--accent); }

.message-body h1, .message-body h2, .message-body h3,
.message-body h4, .message-body h5, .message-body h6 {
	font-family: 'Newsreader', Georgia, serif;
	margin: 1.2em 0 0.5em; font-weight: 500; line-height: 1.3; color: var(--text-strong);
}

.message-body h1 { font-size: 1.4rem; }
.message-body h2 { font-size: 1.2rem; }
.message-body h3 { font-size: 1.05rem; }

/* ── Code ──────────────────────────────── */
.message-body code {
	font-family: 'JetBrains Mono', monospace;
	font-size: 0.85em; background: var(--bg-tertiary);
	padding: 2px 6px; border-radius: 4px; color: var(--text-primary);
}

.message-body pre {
	margin: 1em 0; border-radius: var(--radius);
	overflow: hidden; border: 1px solid var(--border);
}

.code-block-header {
	display: flex; align-items: center; justify-content: space-between;
	padding: 8px 14px; background: var(--code-header-bg);
	border-bottom: 1px solid var(--border);
	font-size: 0.72rem; font-weight: 500;
	color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.05em;
}

.code-copy-btn {
	display: flex; align-items: center; gap: 4px;
	border: none; background: transparent; color: var(--text-muted);
	cursor: pointer; font-size: 0.72rem; font-family: inherit;
	padding: 2px 6px; border-radius: 4px; transition: all var(--transition);
}

.code-copy-btn:hover { color: var(--text-secondary); background: var(--bg-hover); }
.code-copy-btn.copied { color: var(--tool-indicator); }

.message-body pre code {
	display: block; padding: 16px; background: var(--code-bg);
	overflow-x: auto; font-size: 0.82rem; line-height: 1.6; border-radius: 0;
}

/* ── Thinking ──────────────────────────── */
.thinking-block {
	margin: 10px 0; border: 1px solid var(--surface-thinking-border);
	border-radius: var(--radius); overflow: hidden; background: var(--surface-thinking);
}

.thinking-toggle {
	display: flex; align-items: center; gap: 8px;
	width: 100%; padding: 10px 14px; border: none;
	background: transparent; color: var(--thinking-indicator);
	cursor: pointer; font-size: 0.8rem; font-family: inherit;
	font-weight: 500; transition: background var(--transition); text-align: left;
}

.thinking-toggle:hover { background: var(--surface-thinking-hover); }
.thinking-chevron { transition: transform var(--transition); font-size: 10px; }
.thinking-block.open .thinking-chevron { transform: rotate(90deg); }

.thinking-content {
	display: none; padding: 12px 14px 14px; border-top: 1px solid var(--surface-thinking-border);
	font-size: 0.85rem; line-height: 1.65; color: var(--text-secondary);
	white-space: pre-wrap; word-break: break-word;
}

.thinking-block.open .thinking-content { display: block; }

.thinking-summary {
	margin-top: 8px; padding-top: 8px; border-top: 1px dashed var(--surface-thinking-border);
	font-style: italic; color: var(--text-muted); font-size: 0.82rem;
}

/* ── Tool Blocks ───────────────────────── */
.tool-block {
	margin: 10px 0; border: 1px solid var(--surface-tool-border);
	border-radius: var(--radius); overflow: hidden; background: var(--surface-tool);
}

.tool-header {
	display: flex; align-items: center; gap: 8px;
	padding: 10px 14px; font-size: 0.8rem; font-weight: 500;
	color: var(--tool-indicator); cursor: pointer; border: none;
	background: transparent; width: 100%; text-align: left;
	font-family: inherit; transition: background var(--transition);
}

.tool-header:hover { background: var(--surface-tool-hover); }
.tool-chevron { transition: transform var(--transition); font-size: 10px; }
.tool-block.open .tool-chevron { transform: rotate(90deg); }

.tool-content {
	display: none; padding: 12px 14px; border-top: 1px solid var(--surface-tool-border);
	font-family: 'JetBrains Mono', monospace;
	font-size: 0.78rem; line-height: 1.5; color: var(--text-secondary);
	white-space: pre-wrap; word-break: break-word;
	max-height: 300px; overflow-y: auto;
}

.tool-block.open .tool-content { display: block; }

/* ── Attachment Card ───────────────────── */
.attachment {
	display: inline-flex; align-items: center; gap: 10px;
	margin-bottom: 12px; padding: 10px 14px;
	background: var(--surface-attachment);
	border: 1px solid var(--surface-attachment-border); border-radius: var(--radius);
	cursor: pointer; transition: all var(--transition);
	max-width: 100%;
}

.attachment:hover {
	border-color: var(--accent-dim); background: var(--surface-attachment-hover);
}

.attachment-icon {
	width: 32px; height: 32px; border-radius: 6px;
	background: rgba(212, 149, 106, 0.12);
	display: flex; align-items: center; justify-content: center;
	color: var(--accent); font-size: 14px; flex-shrink: 0;
}

.attachment-info { min-width: 0; }

.attachment-name {
	font-size: 0.82rem; font-weight: 500; color: var(--text-primary);
	white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.attachment-detail { font-size: 0.72rem; color: var(--text-muted); margin-top: 1px; }

.attachment-hint {
	font-size: 0.68rem; color: var(--accent-dim); margin-top: 2px;
	opacity: 0; transition: opacity var(--transition);
}

.attachment:hover .attachment-hint { opacity: 1; }

/* ── Attachment Side Panel ─────────────── */
.panel-overlay {
	position: fixed; inset: 0; z-index: 80;
	background: rgba(0, 0, 0, 0.5);
	opacity: 0; pointer-events: none;
	transition: opacity 0.25s ease;
}

.panel-overlay.open { opacity: 1; pointer-events: all; }

.panel {
	position: fixed; top: 0; right: 0; bottom: 0;
	width: var(--panel-width); max-width: 90vw; min-width: 280px;
	z-index: 90;
	background: var(--bg-secondary);
	border-left: 1px solid var(--border);
	display: flex; flex-direction: column;
	transform: translateX(100%);
	transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
	box-shadow: -8px 0 32px rgba(0,0,0,0.4);
}

.panel.open { transform: translateX(0); }

.panel-resize {
	position: absolute; left: -4px; top: 0; bottom: 0;
	width: 8px; cursor: col-resize; z-index: 91;
	transition: background 0.15s ease;
}

.panel-resize:hover,
.panel-resize.active {
	background: var(--accent-dim);
}

.panel-header {
	display: flex; align-items: center; justify-content: space-between;
	padding: 16px 20px;
	border-bottom: 1px solid var(--border);
	flex-shrink: 0;
}

.panel-title-area { min-width: 0; flex: 1; }

.panel-filename {
	font-size: 0.9rem; font-weight: 600; color: var(--text-primary);
	white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
}

.panel-filemeta {
	font-size: 0.72rem; color: var(--text-muted); margin-top: 2px;
}

.panel-actions {
	display: flex; align-items: center; gap: 4px;
	flex-shrink: 0; margin-left: 12px;
}

.panel-btn {
	display: flex; align-items: center; justify-content: center;
	gap: 5px; padding: 6px 10px;
	border: 1px solid var(--border); border-radius: 6px;
	background: var(--bg-tertiary); color: var(--text-secondary);
	font-size: 0.75rem; font-family: inherit; font-weight: 500;
	cursor: pointer; transition: all var(--transition);
	white-space: nowrap;
}

.panel-btn:hover {
	background: var(--bg-hover); color: var(--text-primary); border-color: var(--border-light);
}

.panel-btn.copied { color: var(--tool-indicator); border-color: var(--tool-indicator); }

.panel-btn svg { width: 14px; height: 14px; }

.panel-close {
	display: flex; align-items: center; justify-content: center;
	width: 32px; height: 32px; border: none; border-radius: 6px;
	background: transparent; color: var(--text-muted);
	cursor: pointer; transition: all var(--transition);
	font-size: 18px; margin-left: 4px;
}

.panel-close:hover { background: var(--bg-tertiary); color: var(--text-primary); }

.panel-body {
	flex: 1; overflow-y: auto; padding: 20px;
}

.panel-content {
	font-family: 'JetBrains Mono', monospace;
	font-size: 0.82rem; line-height: 1.65;
	color: var(--text-secondary);
	white-space: pre-wrap; word-break: break-word;
	tab-size: 2;
}

.panel-empty {
	color: var(--text-muted); font-style: italic;
	font-family: 'DM Sans', sans-serif;
	font-size: 0.85rem;
}

/* ── Scrollbar ─────────────────────────── */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-light); border-radius: 3px; }
::-webkit-scrollbar-thumb:hover { background: var(--text-muted); }

/* ── Toast ─────────────────────────────── */
.toast {
	position: fixed; bottom: 24px; left: 50%;
	transform: translateX(-50%) translateY(20px);
	padding: 10px 20px; background: var(--bg-tertiary);
	border: 1px solid var(--border-light); border-radius: 8px;
	font-size: 0.82rem; color: var(--text-secondary);
	box-shadow: var(--shadow-medium);
	opacity: 0; transition: all 0.3s ease;
	pointer-events: none; z-index: 200;
}

.toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

/* ── Responsive ────────────────────────── */
@media (max-width: 640px) {
	.header-badge { display: none; }
	.messages { padding: 16px 16px 60px; }
	.message { padding: 20px 0; }
	.drop-area { padding: 48px 28px; }
	.msg-actions { opacity: 1; }
	.message-timestamp { opacity: 0.6; }
	.panel { width: 100vw; max-width: 100vw; }
}
